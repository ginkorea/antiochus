Cleaned_Command,Description,Target,Context,Command
nmap 192.168.1.1,Scan a single IP nmap 192.168.1.1,192.168.1.1,her Useful Nmap Commands Frequently Asked Questions Target Specification SWITCH EXAMPLE DESCRIPTION nmap 192.168.1.1 Scan a single IP nmap 192.168.1.1 192.168.2.1 Scan specific IPs nmap 192.168.1.1-254 Scan a range nmap scanme.nmap.org Scan a domain n,
nmap 192.168.1.1-254,Scan a range nmap scanme.nmap.org Scan a domain nmap 192.168.1.0/24,192.168.1.0/24,XAMPLE DESCRIPTION nmap 192.168.1.1 Scan a single IP nmap 192.168.1.1 192.168.2.1 Scan specific IPs nmap 192.168.1.1-254 Scan a range nmap scanme.nmap.org Scan a domain nmap 192.168.1.0/24 Scan using CIDR notation -iL nmap -iL targets.txt Scan targets from a file -iR nmap -iR 100 Scan 100,
nmap -iL targets.txt,Scan targets from a file -iR nmap -iR 100 Scan 100 random hosts -exclude nmap -exclude 192.168.1.1,192.168.1.1,54 Scan a range nmap scanme.nmap.org Scan a domain nmap 192.168.1.0/24 Scan using CIDR notation -iL nmap -iL targets.txt Scan targets from a file -iR nmap -iR 100 Scan 100 random hosts -exclude nmap -exclude 192.168.1.1 Exclude listed hosts Nmap Scan Techniques SWITCH EXAMPLE DESCRIPTION -sS nmap 192.168.1.1 -sS TCP SY,
nmap 192.168.1.1 -sS,TCP SYN port scan (Default) -sT nmap 192.168.1.1,192.168.1.1,nmap -exclude 192.168.1.1 Exclude listed hosts Nmap Scan Techniques SWITCH EXAMPLE DESCRIPTION -sS nmap 192.168.1.1 -sS TCP SYN port scan (Default) -sT nmap 192.168.1.1 -sT TCP connect port scan (Default without root privilege) -sU nmap 192.168.1.1 -sU UDP port scan -s,
nmap 192.168.1.1 -sU,UDP port scan -sA nmap 192.168.1.1,192.168.1.1,scan (Default) -sT nmap 192.168.1.1 -sT TCP connect port scan (Default without root privilege) -sU nmap 192.168.1.1 -sU UDP port scan -sA nmap 192.168.1.1 -sA TCP ACK port scan -sW nmap 192.168.1.1 -sW TCP Window port scan -sM nmap 192.168.1.1 -sM TCP Mai,
nmap 192.168.1.1 -sW,TCP Window port scan -sM nmap 192.168.1.1,192.168.1.1,ot privilege) -sU nmap 192.168.1.1 -sU UDP port scan -sA nmap 192.168.1.1 -sA TCP ACK port scan -sW nmap 192.168.1.1 -sW TCP Window port scan -sM nmap 192.168.1.1 -sM TCP Maimon port scan Host Discovery SWITCH EXAMPLE DESCRIPTION -sL nmap 192.168.1.1-3 -sL No Sca,
nmap 192.168.1.1-3 -sL,No Scan. List targets only -sn nmap 192.168.1.1/24,192.168.1.1/24,rt scan -sM nmap 192.168.1.1 -sM TCP Maimon port scan Host Discovery SWITCH EXAMPLE DESCRIPTION -sL nmap 192.168.1.1-3 -sL No Scan. List targets only -sn nmap 192.168.1.1/24 -sn Disable port scanning. Host discovery only. -Pn nmap 192.168.1.1-5 -Pn Disable host discovery. P,
nmap 192.168.1.1-5 -Pn,Disable host discovery. Port scan only. -PS nmap 192.168.1.1-,192.168.1.1,"Scan. List targets only -sn nmap 192.168.1.1/24 -sn Disable port scanning. Host discovery only. -Pn nmap 192.168.1.1-5 -Pn Disable host discovery. Port scan only. -PS nmap 192.168.1.1-5 -PS22-25,80 TCP SYN discovery on port x. Port 80 by default -PA nmap 192.168.1.1-5 -PA22-25,80 TCP",
"nmap 192.168.1.1-5 -PA22-25,80",TCP ACK discovery on port x. Port 80 by default -PU nmap 192.168.1.1-,192.168.1.1,"t scan only. -PS nmap 192.168.1.1-5 -PS22-25,80 TCP SYN discovery on port x. Port 80 by default -PA nmap 192.168.1.1-5 -PA22-25,80 TCP ACK discovery on port x. Port 80 by default -PU nmap 192.168.1.1-5 -PU53 UDP discovery on port x. Port 40125 by default -PR nmap 192.168.1.1-1/24 -PR ARP discovery o",
nmap 192.168.1.1-1/24 -PR ARP,discovery on local network -n nmap 192.168.1.1,192.168.1.1,Port 80 by default -PU nmap 192.168.1.1-5 -PU53 UDP discovery on port x. Port 40125 by default -PR nmap 192.168.1.1-1/24 -PR ARP discovery on local network -n nmap 192.168.1.1 -n Never do DNS resolution Nmap Command Generator Say goodbye to the hassle of trying to remember th,
nmap 192.168.1.1 -p 21,Port scan for port x -p nmap 192.168.1.1,192.168.1.1,"and we will generate the command for you. Generate Port Specification SWITCH EXAMPLE DESCRIPTION -p nmap 192.168.1.1 -p 21 Port scan for port x -p nmap 192.168.1.1 -p 21-100 Port range -p nmap 192.168.1.1 -p U:53,T:21-25,80 Port scan multiple TCP and UDP ports -p",
"nmap 192.168.1.1 -p U:53,T:21-25,80",Port scan multiple TCP and UDP ports -p nmap 192.168.1.1,192.168.1.1,"CRIPTION -p nmap 192.168.1.1 -p 21 Port scan for port x -p nmap 192.168.1.1 -p 21-100 Port range -p nmap 192.168.1.1 -p U:53,T:21-25,80 Port scan multiple TCP and UDP ports -p nmap 192.168.1.1 -p- Port scan all ports -p nmap 192.168.1.1 -p http,https Port scan from service name -F nmap 192.16",
"nmap 192.168.1.1 -p http,https",Port scan from service name -F nmap 192.168.1.1,192.168.1.1,"U:53,T:21-25,80 Port scan multiple TCP and UDP ports -p nmap 192.168.1.1 -p- Port scan all ports -p nmap 192.168.1.1 -p http,https Port scan from service name -F nmap 192.168.1.1 -F Fast port scan (100 ports) -top-ports nmap 192.168.1.1 -top-ports 2000 Port scan the top x ports",
nmap 192.168.1.1 -top-ports 2000,Port scan the top x ports -p-65535 nmap 192.168.1.1,192.168.1.1,"http,https Port scan from service name -F nmap 192.168.1.1 -F Fast port scan (100 ports) -top-ports nmap 192.168.1.1 -top-ports 2000 Port scan the top x ports -p-65535 nmap 192.168.1.1 -p-65535 Leaving off initial port in range makes the scan start at port 1 -p0- nmap 192.168.1.1 -p0-",
nmap 192.168.1.1 -p0-,Leaving off end port in range makes the scan go through to port 65535 Service and Version Detection SWITCH EXAMPLE DESCRIPTION -sV nmap 192.168.1.1,192.168.1.1,535 nmap 192.168.1.1 -p-65535 Leaving off initial port in range makes the scan start at port 1 -p0- nmap 192.168.1.1 -p0- Leaving off end port in range makes the scan go through to port 65535 Service and Version Detection SWITCH EXAMPLE DESCRIPTION -sV nmap 192.168.1.1 -sV Attempts to determine the version of the service running on port -sV -version-intensity nmap 192,
nmap 192.168.1.1 -sV -version-intensity 8,Intensity level 0 to 9. Higher number increases possibility of correctness -sV -version-light nmap 192.168.1.1,192.168.1.1,168.1.1 -sV Attempts to determine the version of the service running on port -sV -version-intensity nmap 192.168.1.1 -sV -version-intensity 8 Intensity level 0 to 9. Higher number increases possibility of correctness -sV -version-light nmap 192.168.1.1 -sV -version-light Enable light mode. Lower possibility of correctness. Faster -sV -version-all nmap,
nmap 192.168.1.1 -sV -version-all,Enable intensity level 9. Higher possibility of correctness. Slower -A nmap 192.168.1.1,192.168.1.1,"1.1 -sV -version-light Enable light mode. Lower possibility of correctness. Faster -sV -version-all nmap 192.168.1.1 -sV -version-all Enable intensity level 9. Higher possibility of correctness. Slower -A nmap 192.168.1.1 -A Enables OS detection, version detection, script scanning, and traceroute OS Detection SWITCH EXAM",
nmap 192.168.1.1 -O,Remote OS detection using TCP/IP stack fingerprinting -O -osscan-limit nmap 192.168.1.1,192.168.1.1,"tion, version detection, script scanning, and traceroute OS Detection SWITCH EXAMPLE DESCRIPTION -O nmap 192.168.1.1 -O Remote OS detection using TCP/IP stack fingerprinting -O -osscan-limit nmap 192.168.1.1 -O -osscan-limit If at least one open and one closed TCP port are not found it will not try OS detec",
nmap 192.168.1.1 -O -osscan-guess,Makes Nmap guess more aggressively -O -max-os-tries nmap 192.168.1.1,192.168.1.1,en and one closed TCP port are not found it will not try OS detection against host -O -osscan-guess nmap 192.168.1.1 -O -osscan-guess Makes Nmap guess more aggressively -O -max-os-tries nmap 192.168.1.1 -O -max-os-tries 1 Set the maximum number x of OS detection tries against a target -A nmap 192.168.1,
nmap 192.168.1.1 -A,"Enables OS detection, version detection, script scanning, and traceroute Timing and Performance SWITCH EXAMPLE DESCRIPTION -T0 nmap 192.168.1.1",192.168.1.1,"p 192.168.1.1 -O -max-os-tries 1 Set the maximum number x of OS detection tries against a target -A nmap 192.168.1.1 -A Enables OS detection, version detection, script scanning, and traceroute Timing and Performance SWITCH EXAMPLE DESCRIPTION -T0 nmap 192.168.1.1 -T0 Paranoid (0) Intrusion Detection System evasion -T1 nmap 192.168.1.1 -T1 Sneaky (1) Intrusion De",
nmap 192.168.1.1 -T1,Sneaky (1) Intrusion Detection System evasion -T2 nmap 192.168.1.1,192.168.1.1,CH EXAMPLE DESCRIPTION -T0 nmap 192.168.1.1 -T0 Paranoid (0) Intrusion Detection System evasion -T1 nmap 192.168.1.1 -T1 Sneaky (1) Intrusion Detection System evasion -T2 nmap 192.168.1.1 -T2 Polite (2) slows down the scan to use less bandwidth and use less target machine resources -T3 n,
nmap 192.168.1.1 -T3,Normal (3) which is default speed -T4 nmap 192.168.1.1,192.168.1.1,-T2 Polite (2) slows down the scan to use less bandwidth and use less target machine resources -T3 nmap 192.168.1.1 -T3 Normal (3) which is default speed -T4 nmap 192.168.1.1 -T4 Aggressive (4) speeds scans; assumes you are on a reasonably fast and reliable network -T5 nmap,
nmap 192.168.1.1 -T5,Insane (5) speeds scan; assumes you are on an extraordinarily fast network Timing and Performance Switches SWITCH EXAMPLE INPUT DESCRIPTION -host-timeout <time> 1s; 4m; 2h Give up on target after this long -min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout <time> 1s; 4m; 2h Specifies probe round trip time -min-hostgroup/max-hostgroup <size<size> 50; 1024 Parallel host scan group sizes -min-parallelism/max-parallelism <numprobes> 10; 1 Probe parallelization -max-retries <tries> 3 Specify the maximum number of port scan probe retransmissions -min-rate <number> 100 Send packets no slower than <number> per second -max-rate <number> 100 Send packets no faster than <number> per second NSE Scripts SWITCH EXAMPLE DESCRIPTION -sC nmap 192.168.1.1,192.168.1.1,.1.1 -T4 Aggressive (4) speeds scans; assumes you are on a reasonably fast and reliable network -T5 nmap 192.168.1.1 -T5 Insane (5) speeds scan; assumes you are on an extraordinarily fast network Timing and Performance Switches SWITCH EXAMPLE INPUT DESCRIPTION -host-timeout <time> 1s; 4m; 2h Give up on target after this long -min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout <time> 1s; 4m; 2h Specifies probe round trip time -min-hostgroup/max-hostgroup <size<size> 50; 1024 Parallel host scan group sizes -min-parallelism/max-parallelism <numprobes> 10; 1 Probe parallelization -max-retries <tries> 3 Specify the maximum number of port scan probe retransmissions -min-rate <number> 100 Send packets no slower than <number> per second -max-rate <number> 100 Send packets no faster than <number> per second NSE Scripts SWITCH EXAMPLE DESCRIPTION -sC nmap 192.168.1.1 -sC Scan with default NSE scripts. Considered useful for discovery and safe -script default nmap 192,
nmap 192.168.1.1 -script,default Scan with default NSE scripts. Considered useful for discovery and safe -script nmap 192.168.1.1,192.168.1.1,168.1.1 -sC Scan with default NSE scripts. Considered useful for discovery and safe -script default nmap 192.168.1.1 -script default Scan with default NSE scripts. Considered useful for discovery and safe -script nmap 192.168.1.1 -script=banner Scan with a single script. Example banner -script nmap 192.168.1.1 -script=http* Scan,
nmap 192.168.1.1 -script=http*,Scan with a wildcard. Example http -script nmap 192.168.1.1,192.168.1.1,"and safe -script nmap 192.168.1.1 -script=banner Scan with a single script. Example banner -script nmap 192.168.1.1 -script=http* Scan with a wildcard. Example http -script nmap 192.168.1.1 -script=http,banner Scan with two scripts. Example http and banner -script nmap 192.168.1.1 -script",
nmap -Pn -script=http-sitemap-generator,"scanme.nmap.org http site map generator nmap -n -Pn -p 80 -open -sV -vvv -script banner,http-title -iR 1000 Fast search for random web servers nmap -Pn -script=dns-brute domain.com Brute forces DNS hostnames guessing subdomains nmap -n -Pn -vv -O -sV -script smb-enum*,smb-ls,smb-mbenum,smb-os-discovery,smb-s*,smb-vuln*,smbv2* -vv 192.168.1.1",192.168.1.1,"ommunity=admin 192.168.1.1 NSE script with arguments Useful NSE Script Examples COMMAND DESCRIPTION nmap -Pn -script=http-sitemap-generator scanme.nmap.org http site map generator nmap -n -Pn -p 80 -open -sV -vvv -script banner,http-title -iR 1000 Fast search for random web servers nmap -Pn -script=dns-brute domain.com Brute forces DNS hostnames guessing subdomains nmap -n -Pn -vv -O -sV -script smb-enum*,smb-ls,smb-mbenum,smb-os-discovery,smb-s*,smb-vuln*,smbv2* -vv 192.168.1.1 Safe SMB scripts to run nmap -script whois* domain.com Whois query nmap -p80 -script http-unsafe-out",
nmap -script,whois* domain.com Whois query nmap -p80 -script http-unsafe-output-escaping scanme.nmap.org Detect cross site scripting vulnerabilities nmap -p80 -script http-sql-injection scanme.nmap.org Check for SQL injections Firewall / IDS Evasion and Spoofing SWITCH EXAMPLE DESCRIPTION -f nmap 192.168.1.1,192.168.1.1,",smb-ls,smb-mbenum,smb-os-discovery,smb-s*,smb-vuln*,smbv2* -vv 192.168.1.1 Safe SMB scripts to run nmap -script whois* domain.com Whois query nmap -p80 -script http-unsafe-output-escaping scanme.nmap.org Detect cross site scripting vulnerabilities nmap -p80 -script http-sql-injection scanme.nmap.org Check for SQL injections Firewall / IDS Evasion and Spoofing SWITCH EXAMPLE DESCRIPTION -f nmap 192.168.1.1 -f Requested scan (including ping scans) use tiny fragmented IP packets. Harder for packet filters -",
nmap 192.168.1.1 -mtu 32,"Set your own offset size -D nmap -D 192.168.1.101,",192.168.1.101,"equested scan (including ping scans) use tiny fragmented IP packets. Harder for packet filters -mtu nmap 192.168.1.1 -mtu 32 Set your own offset size -D nmap -D 192.168.1.101,192.168.1.102,192.168.1.103,192.168.1.23 192.168.1.1 Send scans from spoofed IPs -D nmap -D decoy-ip",
"nmap -D decoy-ip1,decoy-ip2,your-own-ip,decoy-ip3,decoy-ip4",remote-host-ip Above example explained -S nmap -S www.microsoft.com www.facebook.com Scan Facebook from Microsoft (-e eth0 -Pn may be required) -g nmap -g 53 192.168.1.1,192.168.1.1,"D 192.168.1.101,192.168.1.102,192.168.1.103,192.168.1.23 192.168.1.1 Send scans from spoofed IPs -D nmap -D decoy-ip1,decoy-ip2,your-own-ip,decoy-ip3,decoy-ip4 remote-host-ip Above example explained -S nmap -S www.microsoft.com www.facebook.com Scan Facebook from Microsoft (-e eth0 -Pn may be required) -g nmap -g 53 192.168.1.1 Use given source port number -proxies nmap -proxies http://192.168.1.1:8080, http://192.168.1.2:8080",
nmap -proxies,"http://192.168.1.1:8080, http://192.168.1.2:8080 192.168.1.1",192.168.1.1,"osoft (-e eth0 -Pn may be required) -g nmap -g 53 192.168.1.1 Use given source port number -proxies nmap -proxies http://192.168.1.1:8080, http://192.168.1.2:8080 192.168.1.1 Relay connections through HTTP/SOCKS4 proxies -data-length nmap -data-length 200 192.168.1.1 Appends",
nmap -data-length 200,192.168.1.1,192.168.1.1,"080, http://192.168.1.2:8080 192.168.1.1 Relay connections through HTTP/SOCKS4 proxies -data-length nmap -data-length 200 192.168.1.1 Appends random data to sent packets Example IDS Evasion command nmap -f -t 0 -n -Pn --data-length 20",
"nmap -f -t 0 -n -Pn --data-length 200 -D 192.168.1.101,",,192.168.1.101,"h nmap -data-length 200 192.168.1.1 Appends random data to sent packets Example IDS Evasion command nmap -f -t 0 -n -Pn --data-length 200 -D 192.168.1.101,192.168.1.102,192.168.1.103,192.168.1.23 192.168.1.1 Output SWITCH EXAMPLE DESCRIPTION -oN nmap 192.",
nmap 192.168.1.1 -oN normal.file,Normal output to the file normal.file -oX nmap 192.168.1.1,192.168.1.1,"68.1.101,192.168.1.102,192.168.1.103,192.168.1.23 192.168.1.1 Output SWITCH EXAMPLE DESCRIPTION -oN nmap 192.168.1.1 -oN normal.file Normal output to the file normal.file -oX nmap 192.168.1.1 -oX xml.file XML output to the file xml.file -oG nmap 192.168.1.1 -oG grep.file Grepable output to t",
nmap 192.168.1.1 -oG grep.file,Grepable output to the file grep.file -oA nmap 192.168.1.1,192.168.1.1,utput to the file normal.file -oX nmap 192.168.1.1 -oX xml.file XML output to the file xml.file -oG nmap 192.168.1.1 -oG grep.file Grepable output to the file grep.file -oA nmap 192.168.1.1 -oA results Output in the three major formats at once -oG - nmap 192.168.1.1 -oG - Grepable output t,
nmap 192.168.1.1 -oG -,"Grepable output to screen. -oN -, -oX - also usable -append-output nmap 192.168.1.1",192.168.1.1,"the file grep.file -oA nmap 192.168.1.1 -oA results Output in the three major formats at once -oG - nmap 192.168.1.1 -oG - Grepable output to screen. -oN -, -oX - also usable -append-output nmap 192.168.1.1 -oN file.file -append-output Append a scan to a previous scan file -v nmap 192.168.1.1 -v Increase t",
nmap 192.168.1.1 -v,Increase the verbosity level (use -vv or more for greater effect) -d nmap 192.168.1.1,192.168.1.1,ppend-output nmap 192.168.1.1 -oN file.file -append-output Append a scan to a previous scan file -v nmap 192.168.1.1 -v Increase the verbosity level (use -vv or more for greater effect) -d nmap 192.168.1.1 -d Increase debugging level (use -dd or more for greater effect) -reason nmap 192.168.1.1 -reason Di,
nmap 192.168.1.1 -reason,"Display the reason a port is in a particular state, same output as -vv -open nmap 192.168.1.1",192.168.1.1,"ffect) -d nmap 192.168.1.1 -d Increase debugging level (use -dd or more for greater effect) -reason nmap 192.168.1.1 -reason Display the reason a port is in a particular state, same output as -vv -open nmap 192.168.1.1 -open Only show open (or possibly open) ports -packet-trace nmap 192.168.1.1 -T4 -packet-trace Show",
nmap 192.168.1.1 -T4 -packet-trace,Show all packets sent and received -iflist nmap -iflist Shows the host interfaces and routes -resume nmap -resume results.file Resume a scan Helpful Nmap Output examples COMMAND DESCRIPTION nmap -p80 -sV -oG - -open 192.168.1.1/24,192.168.1.1/24,me output as -vv -open nmap 192.168.1.1 -open Only show open (or possibly open) ports -packet-trace nmap 192.168.1.1 -T4 -packet-trace Show all packets sent and received -iflist nmap -iflist Shows the host interfaces and routes -resume nmap -resume results.file Resume a scan Helpful Nmap Output examples COMMAND DESCRIPTION nmap -p80 -sV -oG - -open 192.168.1.1/24 | grep open Scan for web servers and grep to show which IPs are running web servers nmap -iR 10 -n -,
nmap -iR 10 -n -oX out.xml,"| grep ""Nmap"" | cut -d "" "" -f5 > live-hosts.txt Generate a list of the IPs of live hosts nmap -iR 10 -n -oX out2.xml | grep ""Nmap"" | cut -d "" "" -f5 >> live-hosts.txt Append IP to the list of live hosts ndiff scanl.xml scan2.xml Compare output from nmap using the ndif xsltproc nmap.xml -o nmap.html Convert nmap xml files to html files grep "" open "" results.nmap | sed -r ‘s/ +/ /g’ | sort | uniq -c | sort -rn | less Reverse sorted list of how often ports turn up Miscellaneous Nmap Flags SWITCH EXAMPLE DESCRIPTION -6 nmap -6 2607:f0d0:1002:51::4 Enable IPv6 scanning -h nmap -h nmap help screen Other Useful Nmap Commands COMMAND DESCRIPTION nmap -iR 10 -PS22-25,80,113,1050,35000 -v -sn Discovery only on ports x, no port scan nmap 192.168.1.1-",192.168.1.1,"192.168.1.1/24 | grep open Scan for web servers and grep to show which IPs are running web servers nmap -iR 10 -n -oX out.xml | grep ""Nmap"" | cut -d "" "" -f5 > live-hosts.txt Generate a list of the IPs of live hosts nmap -iR 10 -n -oX out2.xml | grep ""Nmap"" | cut -d "" "" -f5 >> live-hosts.txt Append IP to the list of live hosts ndiff scanl.xml scan2.xml Compare output from nmap using the ndif xsltproc nmap.xml -o nmap.html Convert nmap xml files to html files grep "" open "" results.nmap | sed -r ‘s/ +/ /g’ | sort | uniq -c | sort -rn | less Reverse sorted list of how often ports turn up Miscellaneous Nmap Flags SWITCH EXAMPLE DESCRIPTION -6 nmap -6 2607:f0d0:1002:51::4 Enable IPv6 scanning -h nmap -h nmap help screen Other Useful Nmap Commands COMMAND DESCRIPTION nmap -iR 10 -PS22-25,80,113,1050,35000 -v -sn Discovery only on ports x, no port scan nmap 192.168.1.1-1/24 -PR -sn -vv Arp discovery only on local network, no port scan nmap -iR 10 -sn -traceroute Trace",
nmap -iR 10 -sn -traceroute,"Traceroute to random targets, no port scan nmap 192.168.1.1-",192.168.1.1,"x, no port scan nmap 192.168.1.1-1/24 -PR -sn -vv Arp discovery only on local network, no port scan nmap -iR 10 -sn -traceroute Traceroute to random targets, no port scan nmap 192.168.1.1-50 -sL -dns-server 192.168.1.1 Query the Internal DNS for hosts, list targets only nmap 192.168.1.1",
nmap 192.168.1.1 --packet-trace,"Show the details of the packets that are sent and received during a scan and capture the traffic. You are only doing yourself a disservice by failing to learn and utilize all of Nmap’s features. It is the first go-to tool you will use in the scanning and enumeration stage of many assessments, setting the foundation for the rest of your pentest. Keep a copy of this Nmap cheat sheet to refer back to, and consider our Complete Nmap Ethical Hacking Course . It, and many other ethical hacking courses, are available in our VIP Member’s Section. Frequently Asked Questions What is Nmap, and why is it used? Nmap is a free network scanning tool used to discover hosts and services on a network by analyzing responses to various packets and requests. What is the Nmap command used for? Penetration testers and network administrators will use Nmap to discover machines on a network and their open ports, running services, operating systems, and a wealth of other useful information. Is Nmap scanning legal? This depends on your jurisdiction. In many places, the answer is no, not without prior permission from the owner of the site or network. We recommend reading a more complete answer in our article, Is Port Scanning Legal ? What can we hack with Nmap? Nmap is a tool used for scanning and enumeration. Hackers and penetration testers use the information gathered to see what the available attack surface is. However, there are a great number of NSE scripts that can perform such actions as password brute forcing, checking for backup and configuration files, searching for remote file inclusion (RFI) vulnerabilities, and testing default credentials. How do I scan an IP with Nmap? A basic scan of a single IP address is as easy as: nmap <ip> This will return if the host is up and responding to ping, what ports are open, and what services are running on them. More complex commands can be found in the cheat sheet above. Is it OK to Nmap Google? The long answer is, it depends on your jurisdiction. The short answer is, probably not and you shouldn’t do it. Even if it isn’t illegal where you live, it will most certainly violate Google’s terms of service. Do firewalls block Nmap? Firewalls can block access to ports, which would indeed block Nmap. Nmap does have flags to attempt to evade firewalls and intrusion detection systems, which we have listed in the cheat sheet above. Is Nmap a vulnerability? After you have installed Nmap on your host system, an over-ambitious antivirus program may flag it as malicious. So long as you have downloaded it from the official Nmap website , it is safe to have installed. Can Nmap bypass a firewall? Nmap has several optional services which can attempt to bypass firewalls and spoof its scans. See the Firewall / IDS Evasion and Spoofing section above for details. Can Nmap hack WiFi? Nmap has many NSE scripts designed to brute force different services and logins. Depending on the login portal, there may be a relevant script to do so. More realistically, Nmap would be used to enumerate the network, and one of many free programs better suited to WiFi hacking would be used afterward. Can Nmap crack passwords? Nmap has many brute force scripts which will automate password login attempts on various services, such as MySQL, Telenet, and POP3. This may provide a quick win, but password attacks are better handled by tools dedicated to that purpose, such as THC Hydra . How do I read Nmap results? Fortunately, even the more complex Nmap scans display their results in a clear and easy-to-follow manner. You also have the ability to output the data in various forms, including as an XML or grepable file (see the Output section for details). You can also see our Zenmap vs. Nmap article to learn about the graphical version of the tool. 2k SHARES LinkedIn X 2k Facebook Level Up in Cyber Security: Join Our Membership Today! MEMBERSHIP Nathan House Nathan House is the founder and CEO of StationX. He has over 25 years of experience in cyber security, where he has advised some of the largest companies in the world. Nathan is the author of the popular ""The Complete Cyber Security Course"", which has been taken by over half a million students in 195 countries. He is the winner of the AI ""Cyber Security Educator of the Year 2020"" award and finalist for Influencer of the year 2022. Related Articles HTTP Status Codes Cheat Sheet: A Quick Reference When you’re working with web applications, whether as a website Read More » Flipper Zero Tutorial 2024: Best Beginner’s Guide (Easy Steps) In this tutorial, we’ll show you how to get from Read More » The XPath Cheat Sheet Every Developer Needs When you develop a web application, your app inevitably interacts Read More » J says: May 23, 2022 at 8:48 pm THANK YOU!!! I used to use Legion but for some reason the frontend is proving unreliable, so I need to put on my big boy pants and use Nmap the proper way. Reply Raja says: August 16, 2022 at 1:35 pm Thanks Reply Mike says: August 31, 2022 at 3:19 pm Thank you! It’s content like this that helps make the membership cost worth it. Don’t get me wrong, the sheer content on the website makes it worth the cost but this stuff is just icing on the cake! Reply Mike QAAssuming an attacker runs the following command on nmap: “nmap –A –T3 –S 192.168.1.2",192.168.1.2,"nmap 192.168.1.1-50 -sL -dns-server 192.168.1.1 Query the Internal DNS for hosts, list targets only nmap 192.168.1.1 --packet-trace Show the details of the packets that are sent and received during a scan and capture the traffic. You are only doing yourself a disservice by failing to learn and utilize all of Nmap’s features. It is the first go-to tool you will use in the scanning and enumeration stage of many assessments, setting the foundation for the rest of your pentest. Keep a copy of this Nmap cheat sheet to refer back to, and consider our Complete Nmap Ethical Hacking Course . It, and many other ethical hacking courses, are available in our VIP Member’s Section. Frequently Asked Questions What is Nmap, and why is it used? Nmap is a free network scanning tool used to discover hosts and services on a network by analyzing responses to various packets and requests. What is the Nmap command used for? Penetration testers and network administrators will use Nmap to discover machines on a network and their open ports, running services, operating systems, and a wealth of other useful information. Is Nmap scanning legal? This depends on your jurisdiction. In many places, the answer is no, not without prior permission from the owner of the site or network. We recommend reading a more complete answer in our article, Is Port Scanning Legal ? What can we hack with Nmap? Nmap is a tool used for scanning and enumeration. Hackers and penetration testers use the information gathered to see what the available attack surface is. However, there are a great number of NSE scripts that can perform such actions as password brute forcing, checking for backup and configuration files, searching for remote file inclusion (RFI) vulnerabilities, and testing default credentials. How do I scan an IP with Nmap? A basic scan of a single IP address is as easy as: nmap <ip> This will return if the host is up and responding to ping, what ports are open, and what services are running on them. More complex commands can be found in the cheat sheet above. Is it OK to Nmap Google? The long answer is, it depends on your jurisdiction. The short answer is, probably not and you shouldn’t do it. Even if it isn’t illegal where you live, it will most certainly violate Google’s terms of service. Do firewalls block Nmap? Firewalls can block access to ports, which would indeed block Nmap. Nmap does have flags to attempt to evade firewalls and intrusion detection systems, which we have listed in the cheat sheet above. Is Nmap a vulnerability? After you have installed Nmap on your host system, an over-ambitious antivirus program may flag it as malicious. So long as you have downloaded it from the official Nmap website , it is safe to have installed. Can Nmap bypass a firewall? Nmap has several optional services which can attempt to bypass firewalls and spoof its scans. See the Firewall / IDS Evasion and Spoofing section above for details. Can Nmap hack WiFi? Nmap has many NSE scripts designed to brute force different services and logins. Depending on the login portal, there may be a relevant script to do so. More realistically, Nmap would be used to enumerate the network, and one of many free programs better suited to WiFi hacking would be used afterward. Can Nmap crack passwords? Nmap has many brute force scripts which will automate password login attempts on various services, such as MySQL, Telenet, and POP3. This may provide a quick win, but password attacks are better handled by tools dedicated to that purpose, such as THC Hydra . How do I read Nmap results? Fortunately, even the more complex Nmap scans display their results in a clear and easy-to-follow manner. You also have the ability to output the data in various forms, including as an XML or grepable file (see the Output section for details). You can also see our Zenmap vs. Nmap article to learn about the graphical version of the tool. 2k SHARES LinkedIn X 2k Facebook Level Up in Cyber Security: Join Our Membership Today! MEMBERSHIP Nathan House Nathan House is the founder and CEO of StationX. He has over 25 years of experience in cyber security, where he has advised some of the largest companies in the world. Nathan is the author of the popular ""The Complete Cyber Security Course"", which has been taken by over half a million students in 195 countries. He is the winner of the AI ""Cyber Security Educator of the Year 2020"" award and finalist for Influencer of the year 2022. Related Articles HTTP Status Codes Cheat Sheet: A Quick Reference When you’re working with web applications, whether as a website Read More » Flipper Zero Tutorial 2024: Best Beginner’s Guide (Easy Steps) In this tutorial, we’ll show you how to get from Read More » The XPath Cheat Sheet Every Developer Needs When you develop a web application, your app inevitably interacts Read More » J says: May 23, 2022 at 8:48 pm THANK YOU!!! I used to use Legion but for some reason the frontend is proving unreliable, so I need to put on my big boy pants and use Nmap the proper way. Reply Raja says: August 16, 2022 at 1:35 pm Thanks Reply Mike says: August 31, 2022 at 3:19 pm Thank you!  It’s content like this that helps make the membership cost worth it.  Don’t get me wrong, the sheer content on the website makes it worth the cost but this stuff is just icing on the cake! Reply Mike QAAssuming an attacker runs the following command on nmap: “nmap –A –T3 –S 192.168.1.2 –p- 192.168.1.6”. What does the attacker try to achieve? says: September 4, 2023 at 11:02 pm nmap –A",
nmap –A,–T3 –S 192.168.1.2,192.168.1.2,"f is just icing on the cake! Reply Mike QAAssuming an attacker runs the following command on nmap: “nmap –A –T3 –S 192.168.1.2 –p- 192.168.1.6”. What does the attacker try to achieve? says: September 4, 2023 at 11:02 pm nmap –A",
nmap 192.168.1.1 --top-ports 2000,Port scan the top x ports -p-65535 nmap 192.168.1.1,192.168.1.1,"ttp,https Port scan from service name -F nmap 192.168.1.1 -F Fast port scan (100 ports) --top-ports nmap 192.168.1.1 --top-ports 2000 Port scan the top x ports -p-65535 nmap 192.168.1.1 -p-65535 Leaving oﬀ initial port in range makes the scan start at port 1 -p0- nmap 192.168.1.1 -p0-",
nmap 192.168.1.1 -sV --version-intensity 8Intensity,level 0 to 9. Higher number increases possibility of correctness -sV --version-light nmap 192.168.1.1,192.168.1.1,68.1.1 -sV Attempts to determine the version of the service running on port -sV --version-intensity nmap 192.168.1.1 -sV --version-intensity 8Intensity level 0 to 9. Higher number increases possibility of correctness -sV --version-light nmap 192.168.1.1 -sV --version-light Enable light mode. Lower possibility of correctness. Faster -sV --version-all nm,
nmap 192.168.1.1 -sV --version-all,Enable intensity level 9. Higher possibility of correctness. Slower -A nmap 192.168.1.1,192.168.1.1,"1 -sV --version-light Enable light mode. Lower possibility of correctness. Faster -sV --version-all nmap 192.168.1.1 -sV --version-all Enable intensity level 9. Higher possibility of correctness. Slower -A nmap 192.168.1.1 -A Enables OS detection, version detection, script scanning, and tracerouteService and Version Detec",
nmap 192.168.1.1 -O --osscan-guess Makes,Nmap guess more aggressively -O --max-os-tries nmap 192.168.1.1,192.168.1.1,and one closed TCP port are not found it will not try  OS detection against host -O --osscan-guess nmap 192.168.1.1 -O --osscan-guess Makes Nmap guess more aggressively -O --max-os-tries nmap 192.168.1.1 -O --max-os-tries 1 Set the maximum number x of OS detection tries against a target -A nmap 192.168.,
nmap 192.168.1.1 --mtu 32,"Set your own oﬀset size -D nmap -D 192.168.1.101,",192.168.1.101,"quested scan (including ping scans) use tiny fragmented IP packets. Harder for packet filters --mtu nmap 192.168.1.1 --mtu 32 Set your own oﬀset size -D nmap -D 192.168.1.101,192.168.1.102,192.168.1.103,192.168.1.23 192.168.1.1 Send scans from spoofed IPs -D nmap -D decoy-ip",
"nmap --proxies http://192.168.1.1:8080,",http://192.168.1.2:8080 192.168.1.1,192.168.1.1,,
nmap --data-length 200,192.168.1.1,192.168.1.1,", http://192.168.1.2:8080 192.168.1.1 Relay connections through HTTP/SOCKS4 proxies    --data-lengthnmap --data-length 200 192.168.1.1 Appends random data to sent packets    Example IDS Evasion command nmap -f -t 0 -n -Pn --data-length",
nmap 192.168.1.1 -sC,Scan with default NSE scripts. Considered useful for discovery and safe --script default nmap 192.168.1.1,192.168.1.1,"-D 192.168.1.101,192.168.1.102,192.168.1.103,192.168.1.23 192.168.1.1Switch Example Description -sC nmap 192.168.1.1 -sC Scan with default NSE scripts. Considered useful for discovery and safe --script default nmap 192.168.1.1 --script default Scan with default NSE scripts. Considered useful for discovery and safe --script nm",
nmap 192.168.1.1 --script=banner,Scan with a single script. Example banner --script nmap 192.168.1.1,192.168.1.1,"1 --script default Scan with default NSE scripts. Considered useful for discovery and safe --script nmap 192.168.1.1 --script=banner Scan with a single script. Example banner --script nmap 192.168.1.1 --script=http* Scan with a wildcard. Example http --script nmap 192.168.1.1 --script=http,banner Sca",
"nmap 192.168.1.1 --script=http,banner",Scan with two scripts. Example http and banner --script nmap 192.168.1.1,192.168.1.1,"Example banner --script nmap 192.168.1.1 --script=http* Scan with a wildcard. Example http --script nmap 192.168.1.1 --script=http,banner Scan with two scripts. Example http and banner --script nmap 192.168.1.1 --script ""not intrusive""Scan default, but remove intrusive scripts --script-args nmap --script snmp-",
nmap --script snmp-sysdescr --script-args snmpcommunity=admin,192.168.1.1,192.168.1.1,"t nmap 192.168.1.1 --script ""not intrusive""Scan default, but remove intrusive scripts --script-args nmap --script snmp-sysdescr --script-args snmpcommunity=admin 192.168.1.1 NSE script with arguments Useful NSE Script Examples Command Description nmap -Pn --script=http-site",
nmap -Pn --script=http-sitemap-generator,"scanme.nmap.org http site map generator nmap -n -Pn -p 80 --open -sV -vvv --script banner,http-title -iR 1000 Fast search for random web servers nmap -Pn --script=dns-brute domain.com Brute forces DNS hostnames guessing subdomains nmap -n -Pn -vv -O -sV --script smb-enum*,smb-ls,smb-mbenum,smb-os-discovery,smb-s*,smb-vuln*,smbv2* -vv 192.168.1.1",192.168.1.1,"ommunity=admin 192.168.1.1 NSE script with arguments Useful NSE Script Examples Command Description nmap -Pn --script=http-sitemap-generator scanme.nmap.org http site map generator nmap -n -Pn -p 80 --open -sV -vvv --script banner,http-title -iR 1000 Fast search for random web servers nmap -Pn --script=dns-brute domain.com Brute forces DNS hostnames guessing subdomains  nmap -n -Pn -vv -O -sV --script smb-enum*,smb-ls,smb-mbenum,smb-os-discovery,smb-s*,smb-vuln*,smbv2* -vv 192.168.1.1 Safe SMB scripts to run nmap --script whois* domain.com Whois query nmap -p80 --script http-unsafe-o",
nmap --script whois*,"domain.com Whois query nmap -p80 --script http-unsafe-output-escaping scanme.nmap.org Detect cross site scripting vulnerabilities. nmap -p80 --script http-sql-injection scanme.nmap.org Check for SQL injections NSE Scripts Firewall / IDS Evasion and Spoofing www.stationx.net/nmap-cheat-sheet/ 3Command Description nmap -iR 10 -PS22-25,80,113,1050,35000 -v -sn Discovery only on ports x, no port scan nmap 192.168.1.1-",192.168.1.1,",smb-ls,smb-mbenum,smb-os-discovery,smb-s*,smb-vuln*,smbv2* -vv 192.168.1.1 Safe SMB scripts to run nmap --script whois* domain.com Whois query nmap -p80 --script http-unsafe-output-escaping  scanme.nmap.org Detect cross site scripting vulnerabilities. nmap -p80 --script http-sql-injection scanme.nmap.org Check for SQL injections NSE Scripts Firewall / IDS Evasion and Spoofing www.stationx.net/nmap-cheat-sheet/ 3Command Description nmap -iR 10 -PS22-25,80,113,1050,35000 -v -sn Discovery only on ports x, no port scan nmap 192.168.1.1-1/24 -PR -sn -vv Arp discovery only on local network, no port scan nmap -iR 10 -sn -traceroute Trace",
nmap 192.168.1.1 --reason,"Display the reason a port is in a particular state, same output as -vv --open nmap 192.168.1.1",192.168.1.1,"ct)    -d nmap 192.168.1.1 -d Increase debugging level (use -dd or more for greater eﬀect) --reason nmap 192.168.1.1 --reason Display the reason a port is in a particular state, same output as -vv    --open nmap 192.168.1.1 --open Only show open (or possibly open) ports    --packet-trace nmap 192.168.1.1 -T4 --packet-trace",
nmap 192.168.1.1 -T4 --packet-trace,Show all packets sent and received --iflist nmap --iflist Shows the host interfaces and routes --resume nmap --resume results.file Resume a scan Helpful Nmap Output examples Command Description nmap -p80 -sV -oG - --open 192.168.1.1/24,192.168.1.1/24,as -vv    --open nmap 192.168.1.1 --open Only show open (or possibly open) ports    --packet-trace nmap 192.168.1.1 -T4 --packet-trace Show all packets sent and received    --iflist nmap --iflist Shows the host interfaces and routes --resume nmap --resume results.file Resume a scan Helpful Nmap Output examples Command Description nmap -p80 -sV -oG - --open 192.168.1.1/24 | grep open Scan for web servers and grep to show which IPs are running web servers  nmap -iR 10 -n,
nmap -sn,172.30.1.0/24,172.30.1.0/24,"exclude our attacker machine during the scanning process, use the following commands: kali@kali:~$ nmap -sn 172.30.1.0/24 --exclude 172.30.1.50 A ping sweep is a basic scanning technique that’s used by IT professionals to",
nmap 172.30.1.48,"As shown in the following screenshot, Nmap indicates there are 20 TCP open ports and provided the name of their associated services:Using the information from this scan enables you to start ﬁngerprinting your targeted systems. As a penetration tester, you can determine which ports are open and discover how they can be used as a point-of-entry into the target, and look for security vulnerabilities on the running services. As an aspiring ethical hacker and penetration, it’s okay if you don’t initially understand the role and function of service ports on a system. However, its recommended to perform research on anything you’re not familiar with to gain a better understanding of the technology or topic. For instance, there are many service ports and each if associated with a speciﬁc application-layer service, such as TCP port 443 is associated to the Hypertext Transfer Protocol Secure (HTTPS) protocol that’s used for secure web communication. 1. Next, let’s perform an advanced scan to identify the targeted system’s operating system, service versions and retrieve Server Message Block (SMB) details, using the following the commands: kali@kali:~$ nmap -A -T4 -p- 172.30.1.48",172.30.1.48,"the top 1000 ports are open on the Metasploitable 3 (Windows version) virtual machine: kali@kali:~$ nmap 172.30.1.48 As shown in the following screenshot, Nmap indicates there are 20 TCP open ports and provided the name of their associated services:Using the information from this scan enables you to start ﬁngerprinting your targeted systems. As a penetration tester, you can determine which ports are open and discover how they can be used as a point-of-entry into the target, and look for security vulnerabilities on the running services. As an aspiring ethical hacker and penetration, it’s okay if you don’t initially understand the role and function of service ports on a system. However, its recommended to perform research on anything you’re not familiar with to gain a better understanding of the technology or topic. For instance, there are many service ports and each if associated with a speciﬁc application-layer service, such as TCP port 443 is associated to the Hypertext Transfer Protocol Secure (HTTPS) protocol that’s used for secure web communication. 1. Next, let’s perform an advanced scan to identify the targeted system’s operating system, service versions and retrieve Server Message Block (SMB) details, using the following the commands: kali@kali:~$ nmap -A -T4 -p- 172.30.1.48 Let's take a look at each syntax that were used in the preceding command: -A: This enables Nmap to p",
"nmap -p 50-60, nmap -p 80,443","or nmap -p 22 allows you to scan a range, a group or speciﬁc ports numbers. However, using nmap -p- speciﬁes to scan all 65,535 port numbers, keep in mind Nmap scans TCP ports by default. -sV – This syntax enables you to perform service version identiﬁcation of running services on a targeted system. For instance, an Nmap basic scan may indicate port 23 is open and it’s associated to the Telnet, as an ethical hacker is important to determine the service version of this running service. Therefore, using nmap -sV <targeted system> command will identify the service version which can be useful when researching security vulnerabilities on a target. -6 – Using this syntax enables Nmap to perform scans on a targeted IPv6 network or a host with an IPv6 address. Additionally, ethical hackers and penetration testers can use the Ping utility to proﬁle the operating system of a target by analyzing the Time To Live (TTL) value found within the ICMP response messages from the target. For instance, Windows-based operating systems reply with a default TTL value of 128, while Linux-based systems reply with a default TTL value of 64.To better understand how ICMP helps us identify the operating system of a targeted machine, please use the following instuctions: 1. On Kali Linux, use the following commands to send 4 ICMP ECHO Request messages to the Metasploitable 3 (Windows version) virtual machine: kali@kali:~$ ping 172.30.1.48",172.30.1.48,"allows you to specify either a range of targeted ports or speciﬁc ports are open on a system. Using nmap -p 50-60, nmap -p 80,443 or nmap -p 22 allows you to scan a range, a group or speciﬁc ports numbers. However, using nmap -p- speciﬁes to scan all 65,535 port numbers, keep in mind Nmap scans TCP ports by default. -sV – This syntax enables you to perform service version identiﬁcation of running services on a targeted system. For instance, an Nmap basic scan may indicate port 23 is open and it’s associated to the Telnet, as an ethical hacker is important to determine the service version of this running service. Therefore, using nmap -sV <targeted system> command will identify the service version which can be useful when researching security vulnerabilities on a target. -6 – Using this syntax enables Nmap to perform scans on a targeted IPv6 network or a host with an IPv6 address. Additionally, ethical hackers and penetration testers can use the Ping utility to proﬁle the operating system of a target by analyzing the Time To Live (TTL) value found within the ICMP response messages from the target. For instance, Windows-based operating systems reply with a default TTL value of 128, while Linux-based systems reply with a default TTL value of 64.To better understand how ICMP helps us identify the operating system of a targeted machine, please use the following instuctions: 1. On Kali Linux, use the following commands to send 4 ICMP ECHO Request messages to the Metasploitable 3 (Windows version) virtual machine: kali@kali:~$ ping 172.30.1.48 -c 4As shown in the following screenshot, all ICMP responses contained a TTL of 128, which indicates",
nmap 172.30.1.49 -D 172.30.1.48,,172.30.1.48,"easily.1. Next, to perform an Nmap scan using decoys, use the following commands: kali@kali:~$ sudo nmap 172.30.1.49 -D 172.30.1.48 Using the -D syntax enables you to specify one or more decoys. Before Nmap uses the decoy addresses,",
nmap --spoof-mac 0,172.30.1.49,172.30.1.49,"can using a randomized MAC address, use the --spoof-mac 0 command as shown below: kali@kali:~$ sudo nmap --spoof-mac 0 172.30.1.49 The following screenshot shows Nmap generated a random MAC address before performing the scan on tar",
nmap -sT -Pn --spoof-mac,hp 172.30.1.49,172.30.1.49,"vendor, it’s simply as including the vendor’s name, with the following commands: kali@kali:~$ sudo nmap -sT -Pn --spoof-mac hp 172.30.1.49 The following screenshot Nmap using an HP MAC address as the source address:To learn more about the",
nmap -h,"and man nmap commands to view the help menu and manual page. Having completed this section, you have learned how to evade detection on a network while performing scanning using Nmap. Next, you will learn how to perform a stealth scan using Nmap. Stealth scanning techniques By default, Nmap establishes a TCP 3-way handshake on any open TCP ports found on the targeted systems. Once the handshake has been established between the attacker machine and the targeted system, data packets are exchanged between each host. The following diagram shows the TCP 3-way handshake, where Host A is initializing communication with Host B: During a penetration test, it's important to be as stealthy as possible on the network. This creates the eﬀect of a real adversary attempting to compromise the targeted systems on the network,without being caught by the organization's security solutions. However, by establishing a TCP 3- way handshake with the targeted devices, we are making ourselves known to the target.By using Nmap, we can perform a stealth scan (half-open) between the target and our attacker system. A stealth scan does not setup a full TCP 3-way handshake but resets the connection before it’s fully established.The following diagram shows the exchange of TCP packets during an Nmap stealth scan: As shown in the preceding diagram: 1. The attacker machine tricks the target by sending a TCP SYN packet to a speciﬁc port on the targeted system to determine if the port is open. 2. Then, the target system will respond with a TCP SYN/ACK packet if the port is open. 3. Lastly, the attacker will send a TCP RST packet to the target to reset and terminate the connection. To get started with learning stealth scanning techniques, please use the following instuctions: 1. Power-on the Kali Linux and Metasploitable 2 virtual machines. 2. On Kali Linux, open the Terminal and use the following commands to perform a stealth scan on the Metasploitable 2 to identify whether port 80 is open: kali@kali:~$ sudo nmap -sS -p 80 172.30.1.48",172.30.1.48,"HP MAC address as the source address:To learn more about the various functionality of Nmap, use the nmap -h and man nmap commands to view the help menu and manual page. Having completed this section, you have learned how to evade detection on a network while performing scanning using Nmap. Next, you will learn how to perform a stealth scan using Nmap. Stealth scanning techniques By default, Nmap establishes a TCP 3-way handshake on any open TCP ports found on the targeted systems. Once the handshake has been established between the attacker machine and the targeted system, data packets are exchanged between each host. The following diagram shows the TCP 3-way handshake, where Host A is initializing communication with Host B: During a penetration test, it's important to be as stealthy as possible on the network. This creates the eﬀect of a real adversary attempting to compromise the targeted systems on the network,without being caught by the organization's security solutions. However, by establishing a TCP 3- way handshake with the targeted devices, we are making ourselves known to the target.By using Nmap, we can perform a stealth scan (half-open) between the target and our attacker system. A stealth scan does not setup a full TCP 3-way handshake but resets the connection before it’s fully established.The following diagram shows the exchange of TCP packets during an Nmap stealth scan: As shown in the preceding diagram: 1. The attacker machine tricks the target by sending a TCP SYN packet to a speciﬁc port on the targeted system to determine if the port is open. 2. Then, the target system will respond with a TCP SYN/ACK packet if the port is open. 3. Lastly, the attacker will send a TCP RST packet to the target to reset and terminate the connection. To get started with learning stealth scanning techniques, please use the following instuctions: 1. Power-on the Kali Linux and Metasploitable 2 virtual machines. 2. On Kali Linux, open the Terminal and use the following commands to perform a stealth scan on the Metasploitable 2 to identify whether port 80 is open: kali@kali:~$ sudo nmap -sS -p 80 172.30.1.48 Using the -sS syntax to indicate a stealth scan, and the -p operator allow us to specify a targeted",
"nmap -p 139,445",172.30.1.49,172.30.1.49,"to identify whether the targeted system (Metasploitable 2) is running the SMB service: kali@kali:~$ nmap -p 139,445 172.30.1.49 1. The following screenshot shows Nmap was able to identify ports 139 and 445 is open on the targete",
nmap -sU -p 161,172.30.1.48,172.30.1.48,"ings to determine whether SNMP is running the targeted system (Metasploitable 2): kali@kali:~$ sudo nmap -sU -p 161 172.30.1.48 The following screenshot shows SNMP is running on the targeted system on UDP port 161: 1. Next, perf",
"nmap -sV -p 20,21",172.30.1.49,172.30.1.49,"m (Metasploitable 2) is running an FTP service and determine the service version: kali@kali:~$ sudo nmap -sV -p 20,21 172.30.1.49 As shown in the preceding screenshot, port 21 is open and the service is identiﬁed as vsftpd 2.3.4 o",
nmap --script ftp-vsftpd-backdoor,172.30.1.49,172.30.1.49,"e one of the NSE scripts to determine whether vsftpd is vulnerable on the target: kali@kali:~$ sudo nmap --script ftp-vsftpd-backdoor 172.30.1.49 The --script command allows you to specify either a single script, multiple scripts, or a category o",
nmap --script <category-name>,"command, as shown here:kali@kali:~$ sudo nmap --script vuln 172.30.1.49",172.30.1.49,"he vulnerability category. 1. If you want to execute an entire category of scripts, you can use the nmap --script <category-name> command, as shown here:kali@kali:~$ sudo nmap --script vuln 172.30.1.49 When using the vuln category, NSE will use all the vulnerability detection scripts to check for secu",
"nmap -p 80,443,8080",172.30.1.48,172.30.1.48,"ollowing commands to identify whether there’s a web application running on the target: kali@kali:~$ nmap -p 80,443,8080 172.30.1.48 As shown in the following screenshot, web services were found on port 80 and 8080: Web application p",
nmap --script http-sql-injection -p 80,172.30.1.49,172.30.1.49,njection script and perform a scan on a target that has port 80 open for web services: kali@kali:~$ nmap --script http-sql-injection -p 80 172.30.1.49 The following screenshot shows Nmap was able to identify possible SQL Injection at multiple points o,
nmap -A -v -T2,"–-open –-vulners.nse -iL [Internal or External Target List] -oX [month] [Internal or External]_nmap_results.xml I am not claiming Nmap is a replacement for an enterprise solution for continuous vulnerability management solution. But in an instance where budgetary constraints prevent such a purchase, Nmap can be an eﬀective stop-gap measure at zero cost. Before utilizing Nmap, they had very little insight into what resources were even externally accessible, let alone speciﬁc vulnerabilities associated with them. This additional insight into their attack surface let the security team more aware of their security posture and allowed them to more strategically allocate the resources at their disposal to strengthen that posture. Challenge 1 - Getting Hands-on with Basic ScansIn this chapter, we have explored a dozen diﬀerent ﬂags and discussed some use cases for basic scans from an enterprise perspective. Utilize your lab environment to ﬁrst recreate each of the scans that were demonstrated in this chapter. Next, consider ways to modify some of the scans in your lab environment to elicit diﬀerent results. While the information necessary can be found in this chapter, don’t be afraid to refer and dive into the oﬃcial documentation at https://nmap.org/book/man.html. Try to accomplish the following with some basic scans: 1. Add additional verbosity beyond -v 2. Adjust the speed of the scan by reducing the complexity of service versioning and timing 3. Experiment with outputting diﬀerent ﬁle types 4. Scan speciﬁc ports, the top 1000 ports, and all ports on your lab machines Map the attack surface of the systems in your lab, take note of the CPE of each system, and research any known CVEs associated with them. Challenge 2 – Map the Attack Surface of Your Home Network Now that you have some familiarity with Nmap and mapping the attack surface of a lab environment; it is an opportune time to apply this skillset to your life by mapping your personal home network’s attack surface. This can most simply be done by scanning the subnet of your main computer (assuming you have not established network segmentation on your home network). As discussed in the introduction of this chapter, a very similar exercise was eye-opening for me and helped me identify a very troubling security issue with my baby monitor. Perhaps, you will ﬁnd somesimilarly concerning items, or (hopefully) conﬁrm the secure state of your network. As you assess your network’s attack surface, consider the following questions: Which systems would a malicious actor be most likely to target? How can you improve the security of the network? (adding an IDS, Segregating the network, Restricting outbound traﬃc) Are there any systems on your network that you cannot identify? Add the port TCP 1883 to the scan of your home network. This port is associated with MQ Telemetry Transport (MQTT), which is a lightweight communication protocol very common in IoT devices and is not included in the top 1000 most common ports that a default Nmap scan would pick up. Conclusion The ability to accurately and eﬃciently map an attack surface is essential for a successful penetration tester. While Nmap is not the only tool that is used in the process, it can be a powerful asset for adding important context to the bigger picture. As we have seen, the versatility and power of Nmap truly come alive when leveraging multiple ﬂags in tandem to ﬁne-tune the individual scans. Attack surface mapping is not only critical for a penetration test but is also a very helpful skill for a blue team cyber security professional. Being able to understand how a malicious actor would analyze an organization or network and try to identify points of weakness will inherently lead to a better understanding of how to protect against such techniques. This chapter concludes what would generally be considered “basic” Nmap techniques. In the subsequent chapters, we will quickly progress into intermediate and advanced tactics and techniques to fully leverage the capabilities of Nmap in a professional penetrationtest. To that end, it is highly recommended that you take your time in practicing with the lab environment to build your comfort level with the tool and the basic ﬂags that were discussed in this chapter before progressing to ensure a strong foundation is established. In the next chapter, we will continue to build on this foundation and dive deeper into using Nmap to identify speciﬁc vulnerabilities in systems through in-depth reconnaissance and enumeration techniques. Through additional case studies, more intermediate-level ﬂags, and intricate versioning techniques, we will cover both system ﬁngerprinting and vulnerability analysis in far greater detail. By the end of the next chapter, you will be going beyond simply mapping the attack surface of your lab environment and home network, and instead identifying speciﬁc vulnerabilities that could be exploited against those systems. You will become comfortable researching, conﬁrming, and prioritizing what vulnerabilities to focus on, and perhaps most importantly, how to communicate that information to clients. Points to Remember Everything has an attack surface: every application, every network, and every organization. The attack surface simply refers to the systems or platforms a malicious actor could potentially target for exploitation. Mapping an attack surface is the ﬁrst step to understanding how to allocate resources and properly defend it. Nmap is extremely versatile and can be magniﬁed in capacity by utilizing speciﬁc commands (ﬂags), in tandem with one other. By strategically leveraging diﬀerent ﬂags at diﬀerent times, you can use Nmap for multiple purposes during the attack surface mapping process. Focus ﬁrst on identifying the most interesting or unique systems on the perimeter, then utilize more intricate and in-depth scansto further ﬁngerprint that system. A high-severity vulnerability that has no known exploit and CISA has never observed it being used by a malicious actor has less value to you as a penetration tester than a moderate severity issue with known proof of concept exploits that you can leverage. Multiple Choice Questions 1. Which of the following ﬂags would be best used to identify both the operating system and the services running on open ports? a. -A b. -sV c. -sU d. -iL 2. Attack surface mapping often begins with organizational reconnaissance of a root domain. Which of the following tools would be best utilized for subdomain enumeration? a. Nmap b. OWASP Amass c. Metasploit d. BurpSuite 3. An Nmap scan specifying only “-sV” will conduct service version enumeration equivalent to what version-intensity rating? a. 2 b. 5 c. 7 d. 94. A default Nmap scan executes at a speed equivalent to which -Tspeciﬁcation? a. T-2 b. T-3 c. T-4 d. T-5 5. What ﬂag would you use to output scan results to a .xml ﬁle? a. -oX b. -oT c. -oA d. -oAll 6. The following two scans will return the same results. True or false. Nmap -sV 10.0.0.1",10.0.0.1,"g their ﬁnger on the pulse of their organization’s attack surface. This is the scan that they used: nmap -A -v -T2 –-open –-vulners.nse -iL [Internal or External Target List] -oX [month] [Internal or External]_nmap_results.xml I am not claiming Nmap is a replacement for an enterprise solution for continuous vulnerability management solution. But in an instance where budgetary constraints prevent such a purchase, Nmap can be an eﬀective stop-gap measure at zero cost. Before utilizing Nmap, they had very little insight into what resources were even externally accessible, let alone speciﬁc vulnerabilities associated with them. This additional insight into their attack surface let the security team more aware of their security posture and allowed them to more strategically allocate the resources at their disposal to strengthen that posture. Challenge 1 - Getting Hands-on with Basic ScansIn this chapter, we have explored a dozen diﬀerent ﬂags and discussed some use cases for basic scans from an enterprise perspective. Utilize your lab environment to ﬁrst recreate each of the scans that were demonstrated in this chapter. Next, consider ways to modify some of the scans in your lab environment to elicit diﬀerent results. While the information necessary can be found in this chapter, don’t be afraid to refer and dive into the oﬃcial documentation at https://nmap.org/book/man.html. Try to accomplish the following with some basic scans: 1. Add additional verbosity beyond -v 2. Adjust the speed of the scan by reducing the complexity of service versioning and timing 3. Experiment with outputting diﬀerent ﬁle types 4. Scan speciﬁc ports, the top 1000 ports, and all ports on your lab machines Map the attack surface of the systems in your lab, take note of the CPE of each system, and research any known CVEs associated with them. Challenge 2 – Map the Attack Surface of Your Home Network Now that you have some familiarity with Nmap and mapping the attack surface of a lab environment; it is an opportune time to apply this skillset to your life by mapping your personal home network’s attack surface. This can most simply be done by scanning the subnet of your main computer (assuming you have not established network segmentation on your home network). As discussed in the introduction of this chapter, a very similar exercise was eye-opening for me and helped me identify a very troubling security issue with my baby monitor. Perhaps, you will ﬁnd somesimilarly concerning items, or (hopefully) conﬁrm the secure state of your network. As you assess your network’s attack surface, consider the following questions: Which systems would a malicious actor be most likely to target? How can you improve the security of the network? (adding an IDS, Segregating the network, Restricting outbound traﬃc) Are there any systems on your network that you cannot identify? Add the port TCP 1883 to the scan of your home network. This port is associated with MQ Telemetry Transport (MQTT), which is a lightweight communication protocol very common in IoT devices and is not included in the top 1000 most common ports that a default Nmap scan would pick up. Conclusion The ability to accurately and eﬃciently map an attack surface is essential for a successful penetration tester. While Nmap is not the only tool that is used in the process, it can be a powerful asset for adding important context to the bigger picture. As we have seen, the versatility and power of Nmap truly come alive when leveraging multiple ﬂags in tandem to ﬁne-tune the individual scans. Attack surface mapping is not only critical for a penetration test but is also a very helpful skill for a blue team cyber security professional. Being able to understand how a malicious actor would analyze an organization or network and try to identify points of weakness will inherently lead to a better understanding of how to protect against such techniques. This chapter concludes what would generally be considered “basic” Nmap techniques. In the subsequent chapters, we will quickly progress into intermediate and advanced tactics and techniques to fully leverage the capabilities of Nmap in a professional penetrationtest. To that end, it is highly recommended that you take your time in practicing with the lab environment to build your comfort level with the tool and the basic ﬂags that were discussed in this chapter before progressing to ensure a strong foundation is established. In the next chapter, we will continue to build on this foundation and dive deeper into using Nmap to identify speciﬁc vulnerabilities in systems through in-depth reconnaissance and enumeration techniques. Through additional case studies, more intermediate-level ﬂags, and intricate versioning techniques, we will cover both system ﬁngerprinting and vulnerability analysis in far greater detail. By the end of the next chapter, you will be going beyond simply mapping the attack surface of your lab environment and home network, and instead identifying speciﬁc vulnerabilities that could be exploited against those systems. You will become comfortable researching, conﬁrming, and prioritizing what vulnerabilities to focus on, and perhaps most importantly, how to communicate that information to clients. Points to Remember Everything has an attack surface: every application, every network, and every organization. The attack surface simply refers to the systems or platforms a malicious actor could potentially target for exploitation. Mapping an attack surface is the ﬁrst step to understanding how to allocate resources and properly defend it. Nmap is extremely versatile and can be magniﬁed in capacity by utilizing speciﬁc commands (ﬂags), in tandem with one other. By strategically leveraging diﬀerent ﬂags at diﬀerent times, you can use Nmap for multiple purposes during the attack surface mapping process. Focus ﬁrst on identifying the most interesting or unique systems on the perimeter, then utilize more intricate and in-depth scansto further ﬁngerprint that system. A high-severity vulnerability that has no known exploit and CISA has never observed it being used by a malicious actor has less value to you as a penetration tester than a moderate severity issue with known proof of concept exploits that you can leverage. Multiple Choice Questions 1. Which of the following ﬂags would be best used to identify both the operating system and the services running on open ports? a. -A b. -sV c. -sU d. -iL 2. Attack surface mapping often begins with organizational reconnaissance of a root domain. Which of the following tools would be best utilized for subdomain enumeration? a. Nmap b. OWASP Amass c. Metasploit d. BurpSuite 3. An Nmap scan specifying only “-sV” will conduct service version enumeration equivalent to what version-intensity rating? a. 2 b. 5 c. 7 d. 94. A default Nmap scan executes at a speed equivalent to which -Tspeciﬁcation? a. T-2 b. T-3 c. T-4 d. T-5 5. What ﬂag would you use to output scan results to a .xml ﬁle? a. -oX b. -oT c. -oA d. -oAll 6. The following two scans will return the same results. True or false. Nmap -sV 10.0.0.1 -p 80,443 --open -v Nmap –-open -v -sV -p 80,443 10.0.0.1 a. True b. False 7. This US-based organiza",
nmap -A,,,"f the host, as well as the version of each service. To do this, we will use the following syntax: > nmap -A scanme.nmap.org Figure 1.4: Nmap Scan Enumerating Ports, Services, and Operating System As you can",
nmap -sV,,,information about port 80 on this host. This time we will use three diﬀerent ﬂags: -sV -v and -p: >nmap -sV -v -p 22 scanme.nmap.org Figure 1.5: Adding Verbosity and Demonstrating Single Port Scanning This s,
nmap -hFigure,,,"n your command line, which will give you the spark notes version of the options available to you: > nmap -hFigure 1.7: Demonstrating the Nmap help menu Another option is to use the Linux utility ‘man’ to open the",
nmap -v:,,,"nstructions, and conﬁrm success by opening a command prompt and printing the installed version with nmap -v: Figure 2.1: Nmap Versioning 3. Typically, this download on Windows will also come with Zenmap, whic",
nmap -Pn,,,"ity via ICMP 11. You may further conﬁrm connectivity to the host with a very simple Nmap command: > nmap -Pn [host IP] Figure 2.8: Conﬁrming Network Connectivity via Nmap12. Finally, conﬁrm that Legion is ins",
nmap -p,,,"ns, as well as looking for something speciﬁc. Rather than scanning 255 hosts looking for port 4786 (nmap -p 4786 10.0.0.0/24) and then having to scroll through all 255 responses to see which ones say “closed",
nmap --script,,,"me as Nmap--See https://nmap.org/book/man-legal.html"" categories = {""malware"", ""safe""} -- @usage -- nmap --script CVE-2023-20198-Implant-Checker.nse <target(s)> With those administrative details out of the way, th",
nmap -p-,,,"p 80,443 or nmap -p 22 allows you to scan a range, a group or speciﬁc ports numbers. However, using nmap -p- speciﬁes to scan all 65,535 port numbers, keep in mind Nmap scans TCP ports by default. -sV – This",
nmap --spoof-mac,,,"can using a randomized MAC address, use the --spoof-mac 0 command as shown below: kali@kali:~$ sudo nmap --spoof-mac 0 172.30.1.49 The following screenshot shows Nmap generated a random MAC address before performing",
nmap -sT,,,"vendor, it’s simply as including the vendor’s name, with the following commands: kali@kali:~$ sudo nmap -sT -Pn --spoof-mac hp 172.30.1.49 The following screenshot Nmap using an HP MAC address as the source",
nmap -sS,,,"rform a stealth scan on the Metasploitable 2 to identify whether port 80 is open: kali@kali:~$ sudo nmap -sS -p 80 172.30.1.48 Using the -sS syntax to indicate a stealth scan, and the -p operator allow us to",
nmap -sU,,,ings to determine whether SNMP is running the targeted system (Metasploitable 2): kali@kali:~$ sudo nmap -sU -p 161 172.30.1.48 The following screenshot shows SNMP is running on the targeted system on UDP por,
nmap -iL,,,4 Scan a range nmap scanme.nmap.org Scan a domain nmap  192.168.1.0/24 Scan using CIDR notation -iL nmap -iL targets.txt Scan targets from a file -iR nmap -iR 100 Scan 100 random hosts --exclude nmap --exclud,
nmap -iR,,,nmap  192.168.1.0/24 Scan using CIDR notation -iL nmap -iL targets.txt Scan targets from a file -iR nmap -iR 100 Scan 100 random hosts --exclude nmap --exclude 192.168.1.1 Exclude listed hostsTarget Specifica,
nmap --exclude,,,-iL nmap -iL targets.txt Scan targets from a file -iR nmap -iR 100 Scan 100 random hosts --exclude nmap --exclude 192.168.1.1 Exclude listed hostsTarget Specification Scan Techniques Switch Example Description -sS,
nmap -D,,,"ed IP packets. Harder for packet filters --mtu nmap 192.168.1.1 --mtu 32 Set your own oﬀset size -D nmap -D 192.168.1.101,192.168.1.102,192.168.1.103,192.168.1.23 192.168.1.1 Send scans from spoofed IPs -D n",
nmap -S,,,"map -D decoy-ip1,decoy-ip2,your-own-ip,decoy-ip3,decoy-ip4 remote-host-ipAbove example explained -S nmap -S www.microso",
nmap -g,,,o,
nmap --proxies,,,,
nmap -f,,,"ap --data-length 200 192.168.1.1 Appends random data to sent packets    Example IDS Evasion command nmap -f -t 0 -n -Pn --data-length 200 -D 192.168.1.101,192.168.1.102,192.168.1.103,192.168.1.23 192.168.1.1",
nmap -n,,,"ommand Description nmap -Pn --script=http-sitemap-generator scanme.nmap.org http site map generator nmap -n -Pn -p 80 --open -sV -vvv --script banner,http-title -iR 1000 Fast search for random web servers nm",
nmap -p80,,,"mb-vuln*,smbv2* -vv 192.168.1.1 Safe SMB scripts to run nmap --script whois* domain.com Whois query nmap -p80 --script http-unsafe-output-escaping  scanme.nmap.org Detect cross site scripting vulnerabilities.",
nmap --iflist,,,--packet-trace nmap 192.168.1.1 -T4 --packet-trace Show all packets sent and received    --iflist nmap --iflist Shows the host interfaces and routes --resume nmap --resume results.file Resume a scan Helpful Nmap,
nmap --resume,,,l packets sent and received    --iflist nmap --iflist Shows the host interfaces and routes --resume nmap --resume results.file Resume a scan Helpful Nmap Output examples Command Description nmap -p80 -sV -oG - --o,
nmap -6,,,q -c | sort -rn | less  Reverse sorted list of how o,
nmap -cheat,,,scellaneous Options Other Useful Nmap Commands www.stationx.net/nmap-cheat-sheet/ 4www.stationx.net/nmap -cheat -sheet/Identifying Open Ports with Nmap TCP SYN SCAN ( -sS)  TCP connect() SCAN ( -sT) TCP FIN SCAN,
